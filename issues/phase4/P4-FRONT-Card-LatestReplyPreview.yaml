id: P4-FRONT-Card-LatestReplyPreview
phase: 4
layer: FRONT
area: Card
action: LatestReplyPreview
target_file: frontend/components/ThreadCard.tsx
test_file: null
depends_on: ["P1-FRONT-Components-ThreadCard", "P4-FRONT-Components-HeatChip"]
spec_refs:
  - "06"  # フロントエンド設計
estimated_loc: 35

specification:
  purpose: "ThreadCardへの最新返信プレビュー追加"
  
  content_requirements:
    - section: "プレビュー表示"
      items:
        - "最新コメントの先頭20文字（削除済みは '[削除済み]' 表示）"
        - "「...」で省略"
        - "著者公開属性（authorAffiliation）を表示（あれば）"
        - "相対時間（「5分前」等）"
    
    - section: "レイアウト統合"
      items:
        - "カード下部に追加"
        - "グレーアウト表示"
        - "1行に収める"
        - "HeatChip併記"
    
    - section: "表示条件"
      items:
        - "コメントがある場合のみ"
        - "コメント0件時は非表示"
        - "削除済みコメントは本文を置換して表示（ラベルのみ）"
        - "最新の有効コメント表示"
    
    - section: "スタイリング"
      items:
        - "フォントサイズ小さめ"
        - "薄い文字色"
        - "アイコン付き（💬）"
        - "overflow省略"

  output_format: "TypeScript React Component更新"

constraints:
  - "既存レイアウトを壊さない"
  - "1行表示厳守"
  - "パフォーマンス考慮"

test_specification:
  validation:
    - "最新コメントが表示されること"
    - "長文が省略されること"
    - "コメントなしで非表示"

definition_of_done:
  - "ThreadCard.tsxが更新されている"
  - "最新返信プレビューが追加されている"
  - "HeatChipが統合されている"